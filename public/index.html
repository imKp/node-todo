<!DOCTYPE html>
<html>
<head>
	<title>Light Pixel Animation Display</title>
	<!-- -->
</head>
<style>	
	 rect.bordered {
        stroke: #E6E6E6;
        stroke-width:2px;   
      }

      text.mono {
        font-size: 9pt;
        font-family: Consolas, courier;
        fill: #aaa;
      }

      text.axis-workweek {
        fill: #000;
      }

      text.axis-worktime {
        fill: #000;
      }

     .axis {
	  font: 10px sans-serif;
	}

	.axis path,
	.axis line {
	  fill: none;
	  stroke: #000;
	  shape-rendering: crispEdges;
	}
	li{
		padding-right: 40px;
		text-align:center;
	}
	#containor{
		text-align:center;	
		padding-left:15%;
		padding-right:15%;	
		width:960px;	
	}
    	#heatMap{
		text-align: center;
		padding: 200px;
		margin:10px;
	}
	#inds{
	position:absolute;
	top:10px;
	left:10px; float:right;
}



</style>
<script src="https://d3js.org/d3.v3.js"></script>
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="https://d3js.org/d3-queue.v3.min.js"></script>
<body>
    <!--
        <div id="container">
                <div id="chart" align="left"></div>
                <div id="colorSelectorMenu" align="left"></div>
                <div id="matrixRow" align="center"></div>
                <div id="matrixColumn" align="left"></div>
                <button class="btn1">Done</button>
        
                <input type="text" id="nameOfDesign">
                <div id="saveDesign">
                    <input name="updateButton" type="button" value="Save Design" onclick="updateDesign()" />
                </div>
        
                <div id="animatePlay">
                    <input name="animatePlayBtn" type="button" value="Play Animation" onclick="syncPlayAnimation()" />
        
                </div>
                <div id="searchDesignDD">
                    <input name="searchDesignDDButton" type="button" value="Load Design" onclick="retriveNames()" />
                </div>
                <div id="designView" align="left"></div>
                <input type="text" id="nameOfEditedDesign">
                <div id="saveEditedDesign">
                    <input name="updateButton" type="button" value="Save Updated Design" onclick="updateDesignSave()" />
                </div>
                <div id="animateDesignLeft">
                    <input name="animateDesignLeft" type="button" value="Animate Left" onclick="animateDesignLeft()" />
                </div>
        
                <div id="animateDesignRight">
                    <input name="animateDesignRight" type="button" value="Animate Right" onclick="animateDesignRight()" />
                </div>
                <div id="animateUp">
                    <input name="animateUp" type="button" value="Animate Up" onclick="animateDesignUp()" />
                </div>
                <div id="animateDown">
                    <input name="animateDown" type="button" value="Animate Down" onclick="animateDesignDown()" />
                </div>
                <div id="animateDiagonalRightUp">
                    <input name="animateDiagonalRightUp" type="button" value="Animate DiagonalRightUp" onclick="animateDesignDiagonalRightUp()"
                    /></div>
                    <div id="animateDiagonalLeftUp">
                        <input name="animateDiagonalLeftUp" type="button" value="Animate DiagonalLeftUp" onclick="animateDesignDiagonaLeftUp()" />
                        </div>
                            <div id="animateDiagonalLeftDown">
                            <input name="animateDiagonalLeftDown" type="button" value="Animate DiagonalLeftDown" onclick="animateDesignDiagonalLeftDown()"
                            />
                        </div>
                        <div id="animateDiagonalRightDown">
                            <input name="animateDiagonalRightDown" type="button" value="Animate DiagonalRightDown" onclick="animateDesignDiagonalRightDown()"
                            />
                        </div>
                        <div id="animateUpLeftDownRight">
                            <input name="animateUpLeftDownRight" type="button" value="Animate UpLeftDownRight" onclick="animateDesignUpLeftDownRight()"
                            />
                        </div>
                        <div id="animateUpRightDownLeft">
                            <input name="animateUpRightDownLeft" type="button" value="Animate UpRightDownLeft" onclick="animateDesignUpRightDownLeft()"
                            />
                        </div>
                        <div id="animateLeftUpRightDown">
                            <input name="animateLeftUpRightDown" type="button" value="Animate LeftUpRightDown" onclick="animateDesignLeftUpRightDown()"
                            />
                        </div>
                        <div id="animateLeftDownRightUp">
                            <input name="animateLeftDownRightUp" type="button" value="Animate LeftDownRightUp" onclick="animateDesignLeftDownRightUp()"
                            /></div>
                            <div id="animateRepeat">
                                <input name="animateRepeat" type="button" value="animateRepeat" onclick="animateRepeat(30)" />
        
                            </div>
                            <div id="animateStop">
                                <input name="animateRepeatStop" type="button" value="animateRepeatStop" onclick="myStopFunction()" />
        
                            </div>
                            
                            <div>
                                <input type="range" min="10" max="100" id="nRadius">
                            </div>
        
                            <div id="animationsMenu" align="left"></div>
                            <div id="numberOfFrames" align="left"></div>
                            <div id="nameOfDesigninFrame" align="left"></div>
                            <div id="timeForNxtFrame" align="left"></div>
                            
                            
                            <div id="addFrames">
                                <input name="addFramesBtn" type="button" value="Add Frame" onclick="addAFrame()" />
                            </div>
                            <div id="showMe">
                                <input name="showMeBtn" type="button" value="Show Me" onclick="showMeFunc()" />
                            </div>
                            <div id="addMe">
                                <input name="addMeBtn" type="button" value="Add Me" onclick="addMeFunc()" />
                            </div>
                            <div id="removeFrame">
                                <input name="removeFrameBtn" type="button" value="Remove Last Frame" onclick="removeLastFrame()" />
                            </div>
                            <input type="text" id="nameOfAnimation">		
                            <div id="createAnimation">
                                <input name="createAnimationBtn" type="button" value="Create Animation" onclick="createAnimation()" />
                            </div>	
                            <div id="getAnimationFromDb">
                                <input name="getAnimationFromDbBtn" type="button" value="Load Animation" onclick="retriveAnimationNames()" />
                            </div>
                        
                            <div id="searchAnimationDD">
                                <input name="searchAnimationDDBtn" type="button" value="Get Animation" onclick="getAnimationFromDb()" />
                            </div>
        
                            <div id="processAnimationFile">
                                <input name="processAnimationBtn" type="button" value="Process Animation" onclick="processAnimationFile()" />
                            </div>
        
                            <div id="generateTheCode">
                                <input name="generateTheCode" type="button" value="Generate Code" onclick="generateTheCodeFuncForNoSize()" />
                            </div>
                            <div>
                            <input type = "text"
                            id = "programOutput" /></div>
            </div>
        -->   

<div id = "main-container"> 
    <div id = "matrix-creation-section">
        <div id = "color-menu"> 
            <p>Hello</p>
        </div>
        <div id = "design-preview-section">
            <p>Hello</p> 
        </div>
        <div id = "animation-options">
            <p>Hello</p>
        </div>
    </div>
    <div id = "animation-creation-section">

    </div>
</div>
<script>



            var margin = { top: 50, right: 0, bottom: 100, left: 30 },
                width = 2000 - margin.left - margin.right,
                height = 500 - margin.top - margin.bottom,
                gridSize = Math.floor(width / 24),
                legendElementWidth = gridSize * 2,
                buckets = 9,
                colors = ["#ffffd9", "#edf8b1", "#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494", "#081d58"], // alternatively colorbrewer.YlGnBu[9]
                days = ["1R", "2R", "3R", "4R", "5R", "6R", "7R", "8R"],
                times = ["1C", "2C", "3C", "4C", "5C", "6C", "7C", "8C"];



            var svg = d3.select("#chart").append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


            /*var drawPixel = function(numRow, numCol){
                        d3.selectAll("#chart rect").remove();
                        d3.json("designOne.json", function(error, data){
                            //console.log(typeof(data));
                            
                            for(var propt in data){
                                    var valuesArrayTemp = [];						
                                for(var i = 0; i< numCol; i++){						
                                valuesArrayTemp.push(data[propt][i]);								
                                //console.log(data[8][i]);	
                                }				
                                dataRow = valuesArrayTemp;	
                                //console.log(dataRow);		
                                svg.selectAll("chart")
                                .data(dataRow).enter()
                                .append("rect")
                                .attr("x", function(data, i){ return i * 15;})
                                            .attr("y", function(data, i){ return propt * 15;})
                                            .attr("width",  14)
                                            .attr("height", 14).style('fill', "white").style('stroke-width', 0.7).style('stroke', "black")
                                .on("click", function(d){d3.select(this).style('fill', function(){var color = onchangeColor(); return color;}); })
                                .on("dblclick", function(d){d3.select(this).style('fill', "white"); onchangeColor();});
                            //.on("mouseover", function(){console.log("Yep! you hit me.");});
    
                            }						
                        });						
                    }*/

            var drawMatrix = function (numRow, numCol) {
                //console.log(numRow, numCol);
                d3.selectAll("#chart rect").remove();
                var row;
                var column;
                for (row = 1; row <= numRow; row++) {//console.log(numCol);
                    for (column = 1; column <= numCol; column++) {
                        data = [column];
                        //console.log(data);
                        svg.selectAll("#chart")
                            .data(data).enter()
                            .append("rect")
                            .attr("x", function () { console.log(column); return column * 15; })
                            .attr("y", function () { return row * 15; })
                            .attr("width", 14)
                            .attr("height", 14).style('fill', "white").style('stroke-width', 0.7).style('stroke', "black")
                            .on("click", function (d) { d3.select(this).style('fill', function () { var color = onchangeColor(); return color; }); })
                            .on("mousedown", function (d) {

                                var div = d3.select(this)
                                    .classed("active", true);
                                var w = d3.selectAll("#chart rect")
                                    .on("mousemove", mousemove)
                                    .on("mouseup", mouseup);


                                d3.event.preventDefault(); // disable text dragging
                                function mousemove() {
                                    d3.select(this).style('fill', function () { var color = onchangeColor(); return color; });
                                }
                                function mouseup() {
                                    div.classed("active", false);
                                    w.on("mousemove", null).on("mouseup", null);
                                }

                            })
                            .on("dblclick", function (d) { d3.select(this).style('fill', "white"); onchangeColor(); });
                        //console.log("You hit me!");
                    }
                };
                /*for(i = 1; i <= 32; i++){
                    console.log(i);}*/
            }


            //svg.selectAll("#chart rect").on("mouseover", function(){console.log("Yep! you hit me.");});

            var dataColor = ["red", "blue", "green", "yellow", "magenta", "cyan", "white", "black"];

            var selectColor = d3.select('#colorSelectorMenu')
                .append('select')
                .attr('class', 'select')
                .attr('size', 8)
                .on('change', onchangeColor());

            var optionsColor = selectColor
                .selectAll('option')
                .data(dataColor).enter()
                .append('option')

                .text(function (d) { return d; }).attr;

            function onchangeColor() {
                selectValue = d3.select('#colorSelectorMenu select').property('value');
                //console.log(selectValue);
                //colorsOfElement();
                return selectValue;
            };

            var globalPixelData = [];

            function colorsOfElement() {
                d3.selectAll("#chart rect").each(function (d, i) {
                    //console.log(typeof(d3.select(this).style("fill"))); 
                    var rgb = d3.select(this).style("fill").match(/\d+/g);
                    //console.log(rgb); 
                    globalPixelData.push(rgb);
                })
            }

            /********/

            var matrixRowData = [];

            matrixRowData = function () {
                var tempRowData = [1]
                for (i = 1; i <= 52; i++) {
                    //if (i % 2 == 0) { tempRowData.push(i); }
                    tempRowData.push(i);
                    //console.log(tempRowData);
                }

                return tempRowData;
            }


            var matrixRow = d3.select('#matrixRow')
                .append('select')
                .attr('class', 'select')
                .on("change", function (d) { var nosOfColumn = onchangeColumn(); var nosOfRow = onchangeRow(); drawMatrix(nosOfRow, nosOfColumn) });


            var optionsRow = matrixRow
                .selectAll('option')
                .data(matrixRowData).enter()
                .append('option')
                .text(function (d) { return d; });

            function onchangeRow() {
                selectValue = d3.select('#matrixRow select').property('value');
                //console.log(selectValue);
                return selectValue;
            };



            /******/
            var matrixColumnData = [];
            var globalFileName;

            matrixColumnData = function () {
                var tempColumnData = [1]
                for (i = 1; i <= 52; i++) {
                    //if (i % 2 == 0) { tempColumnData.push(i); }
                    tempColumnData.push(i);
                    //console.log(tempColumnData);
                }

                return tempColumnData;
            }


            var matrixColumn = d3.select('#matrixColumn')
                .append('select')
                .attr('class', 'select')
                .on("change", function (d) { var nosOfColumn = onchangeColumn(); var nosOfRow = onchangeRow(); drawMatrix(nosOfRow, nosOfColumn) });


            var optionsColumn = matrixColumn
                .selectAll('option')
                .data(matrixColumnData).enter()
                .append('option')
                .text(function (d) { return d; });

            function onchangeColumn() {
                selectValue = d3.select('#matrixColumn select').property('value');
                //console.log(selectValue);
                return selectValue;
            };


            /*function updateDesignNew(){
              d3.xhr('http://localhost:8080/api/todos')
                .header("Content-Type", "application/json")
                .post(
                    JSON.stringify({name: "bob", order: [4, 4], pixel: [20, 30, 40]})
                );
            }*/

            function updateDesign() {
                globalPixelData = [];
                var name = document.getElementById("nameOfDesign").value;
                var orderData = [];
                var pixelData = [];
                orderData.push(onchangeRow());
                orderData.push(onchangeColumn());
                //nameOfDesignF();
                var name = document.getElementById("nameOfDesign").value + orderData.toString();
                colorsOfElement();
                /*	var dataToPut = JSON.stringify({text: name, 
                        order: orderData, 
                        pixel: globalPixelData });*/
                //console.log(typeof(name));
                d3.xhr('http://localhost:8080/api/todos/')
                    .header("Content-Type", "application/json")
                    .post(
                        JSON.stringify({
                            text: name,
                            order: orderData,
                            pixel: globalPixelData
                        })
                    );

                /*d3.json('https://http://192.168.2.8:8080/api/todos/', {
                  method:"POST",
                  body: JSON.stringify({
                        text: name, 
                    order: orderData, 
                    pixel: globalPixelData
                  }),
                  headers: {
                    "Content-type": "application/json; charset=UTF-8"
                  }
                });/*
                //.then(function(){alert("Save!");});
            */
                /*d3.request("http://192.168.2.8:8080/api/todos/")
                .header("Content-Type", "application/json")
                .post(dataToPut, function (error,data) {console.log(data);});*/

            }



            $(document).ready(function () {
                $(".btn1").click(function () {
                    $("#matrixRow").hide(); $("#matrixColumn").hide();
                });
            });

            /******/

            var nameOfDesignBox = d3.select('#nameOfDesign')

            nameOfDesignBox.append('input')
                .attr('type', 'text')
                .attr('name', 'textInput');

            function nameOfDesignF() {
                d3.selectAll("#nameOfDesign input").each(function (d, i) {
                    globalFileName = d3.select(this).attr("value");
                })
            }


            /********/

            var designNamesFromdb = [];


            var titleToGuide = ["Look For your Designs Here"];



            var designSearchDD = d3.select('#searchDesignDD')
                .append('select')
                .attr('class', 'select')
                .attr('size', 5)
                .attr('id', 'designFromDb');
            //.on("click", function(){console.log("Yep Hit Me!"); nameOfTheDesign();});	



            var optionsSaved = designSearchDD
                .selectAll('option')
                .data(titleToGuide).enter()
                .append('option')
                .text(function (d) { return d; });

            function retriveNames() {
                d3.selectAll("#searchDesignDD option").remove();
                d3.json("http://localhost:8080/api/todos", function (error, data, i) {
                    designNamesFromdb = [];
                    for (var i = 0; i < data.length; i++) {
                        var optionsSaved = designNamesFromdb.push(data[i]["text"]);
                    }
                    designSearchDD.selectAll('option')
                        .data(designNamesFromdb).enter()
                        .append('option').sort(d3.ascending)
                        .text(function (d) { return d; })
                        .on("click", function () { nameOfTheDesign = d3.select(this).property('value');/*console.log("Yep Hit Me!"); console.log(nameOfTheDesign);*/ loadDesign(nameOfTheDesign); });
                });
            }

            /*function nameOfTheDesign() {
                selectValue = d3.select('#searchDesignDD option').property('value');
                console.log(selectValue);
                return selectValue;
            };*/

            /*********/

            var designmargin = { top: 50, right: 0, bottom: 100, left: 30 },
                designwidth = 700 - designmargin.left - designmargin.right,
                dsignheight = 700 - designmargin.top - designmargin.bottom,
                designgridSize = Math.floor(designwidth / 24),
                designlegendElementWidth = designgridSize * 2;
            /*buckets = 9,
            colors = ["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"], // alternatively colorbrewer.YlGnBu[9]
            days = ["1R", "2R", "3R", "4R", "5R", "6R", "7R", "8R"],
            times = ["1C", "2C", "3C", "4C", "5C", "6C", "7C", "8C"];*/



            var designsvg = d3.select("#designView").append("svg")
                .attr("width", designwidth + designmargin.left + designmargin.right)
                .attr("height", dsignheight + designmargin.top + designmargin.bottom)
                .append("g")
                .attr("transform", "translate(" + designmargin.left + "," + designmargin.top + ")");



            designRect = [1];

            var orderOfUpdatedMatrix = [];

            var loadDesign = function (nameOfTheDesign) {

/*console.log(nameOfTheDesign);*/d3.selectAll("#designView rect").remove();
                url = 'http://localhost:8080/api/todos/text/' + nameOfTheDesign;
                d3.json(url, function (error, data) {
                    orderOfUpdatedMatrix = data[0]["order"]
                    nosOfRows = data[0]["order"][0];
                    nosOfColumn = data[0]["order"][1];
                    pixelInfo = data[0]["pixel"];
                    console.log(nosOfRows, nosOfColumn, pixelInfo);
                    designsvg.selectAll("#designView")
                        .data(pixelInfo).enter()
                        .append("rect")
                        .attr("x", function (d, i) { valueOfx = i % nosOfColumn; return valueOfx * 15; })
                        .attr("y", function (d, i) { valueOfy = Math.floor(i / nosOfColumn); return valueOfy * 15; })
                        .attr("width", 14)
                        .attr("height", 14).style('fill', function (d, i) {
                            console.log(d.toString());
                            rgbValue = "rgb(" + d.toString() + ")";
                            return rgbValue;
                        })
                        .style('stroke-width', 0.7).style('stroke', "black")
                        .on("click", function (d) { d3.select(this).style('fill', function () { var color = onchangeColor(); return color; }); })
                        .on("mousedown", function (d) {

                            var div = d3.select(this)
                                .classed("active", true);
                            var wEdit = d3.selectAll("#designView rect")
                                .on("mousemove", mousemoveEdit)
                                .on("mouseup", mouseupEdit);


                            d3.event.preventDefault(); // disable text dragging
                            function mousemoveEdit() {
                                d3.select(this).style('fill', function () { var color = onchangeColor(); return color; });
                            }


                            function mouseupEdit() {
                                div.classed("active", false);
                                wEdit.on("mousemove", null).on("mouseup", null);
                            }

                        })
                        .on("dblclick", function (d) { d3.select(this).style('fill', "white"); onchangeColor(); });

                });
            }

            var globalPixelDataUpdate = [];


            function colorsOfElementUpdated() {
                globalPixelDataUpdate = [];
                d3.selectAll("#designView rect").each(function (d, i) {
                    //console.log(typeof(d3.select(this).style("fill"))); 
                    var rgb = d3.select(this).style("fill").match(/\d+/g);
                    //console.log(rgb); 
                    globalPixelDataUpdate.push(rgb);
                })
            }

            updateDesignSave = function () {
                colorsOfElementUpdated();
                console.log(globalPixelDataUpdate);
                console.log(orderOfUpdatedMatrix);

                var name = document.getElementById("nameOfEditedDesign").value;
                colorsOfElementUpdated()
                //console.log(typeof(name));
                d3.xhr('http://localhost:8080/api/todos/')
                    .header("Content-Type", "application/json")
                    .post(
                        JSON.stringify({
                            text: name,
                            order: orderOfUpdatedMatrix,
                            pixel: globalPixelDataUpdate
                        })
                    );
                alert("Save");
            }


            var animateDesignLeft = function () {
                //globalPixelDataUpdate = [];	
                //console.log("Animation Called");
                nosOfColumn = orderOfUpdatedMatrix[1];
                colorsOfElementUpdated();
                d3.selectAll("#designView rect").style("fill", function (d, i) {
                    //console.log(i);
                    //console.log(globalPixelDataUpdate[i + 1]);
                    // var plusOne = i + 1; 
                    //var specialCase = i - nosOfColumn + 1; 
                    var color;
                    if ((i % parseInt(nosOfColumn)) == (parseInt(nosOfColumn) - 1)) { color = 'rgb(' + globalPixelDataUpdate[i - parseInt(nosOfColumn) + 1].toString() + ')'; /*console.log(color);*/ return color; }
                    else { color = 'rgb(' + globalPixelDataUpdate[i + 1].toString() + ')'; return color; }

                    //d3.select(this).style('fill', "white");	
                });
            }

            var animateDesignRight = function () {
                //globalPixelDataUpdate = [];	
                nosOfColumn = orderOfUpdatedMatrix[1];
                colorsOfElementUpdated();
                lengthOfArray = globalPixelDataUpdate.length; console.log(lengthOfArray);
                d3.selectAll("#designView rect").style("fill", function (d, i) {
                    //console.log(i);
                    //console.log(globalPixelDataUpdate[i + 1]);
                    //var plusOne = i + 1; 


                    //console.log(specialCase, nosOfColumn, "special");
                    var color;
                    if (i % parseInt(nosOfColumn) == 0) { color = 'rgb(' + globalPixelDataUpdate[i + parseInt(nosOfColumn) - 1].toString() + ')'; return color; }
                    else { color = 'rgb(' + globalPixelDataUpdate[i - 1].toString() + ')'; return color; }

                    //d3.select(this).style('fill', "white");	
                });
            }

            var animateDesignUp = function () {
                //globalPixelDataUpdate = [];	
                nosOfColumn = parseInt(orderOfUpdatedMatrix[1]);
                nosOfRows = parseInt(orderOfUpdatedMatrix[0]);
                colorsOfElementUpdated();
                d3.selectAll("#designView rect").style("fill", function (d, i) {
                    //console.log(i);
                    //console.log(globalPixelDataUpdate[i + 1]);
                    // var plusOne = i + 1; 
                    //var specialCase = i - nosOfColumn + 1; 
                    var color;
                    if (i >= ((nosOfColumn * nosOfRows) - nosOfColumn)) { color = 'rgb(' + globalPixelDataUpdate[i - ((nosOfColumn * nosOfRows) - nosOfColumn)].toString() + ')'; return color; }
                    else { color = 'rgb(' + globalPixelDataUpdate[i + nosOfColumn].toString() + ')'; return color; }
                    //d3.select(this).style('fill', "white");	
                });
            }

            var animateDesignDown = function () {
                //globalPixelDataUpdate = [];	
                nosOfColumn = parseInt(orderOfUpdatedMatrix[1]);
                nosOfRows = parseInt(orderOfUpdatedMatrix[0]);
                colorsOfElementUpdated();
                d3.selectAll("#designView rect").style("fill", function (d, i) {
                    //console.log(i);
                    //console.log(globalPixelDataUpdate[i + 1]);
                    // var plusOne = i + 1; 
                    //var specialCase = i - nosOfColumn + 1; 
                    var color;
                    if (i < nosOfColumn) { color = 'rgb(' + globalPixelDataUpdate[i + ((nosOfColumn * nosOfRows) - nosOfColumn)].toString() + ')'; return color; }
                    else { color = 'rgb(' + globalPixelDataUpdate[i - nosOfColumn].toString() + ')'; return color; }
                    //d3.select(this).style('fill', "white");	
                });
            }

            var animateDesignDiagonalRightUp = function () {
                //globalPixelDataUpdate = [];	
                nosOfColumn = parseInt(orderOfUpdatedMatrix[1]);
                nosOfRows = parseInt(orderOfUpdatedMatrix[0]);
                colorsOfElementUpdated();
                d3.selectAll("#designView rect").style("fill", function (d, i) {
                    //console.log(i);
                    //console.log(globalPixelDataUpdate[i + 1]);
                    // var plusOne = i + 1; 
                    //var specialCase = i - nosOfColumn + 1; 
                    var color;
                    if (i == (nosOfRows * nosOfColumn) - 1) { color = 'rgb(' + globalPixelDataUpdate[0].toString() + ')'; return color; }
                    else if (i >= ((nosOfColumn * nosOfRows) - nosOfColumn)) { color = 'rgb(' + globalPixelDataUpdate[i - ((nosOfColumn * nosOfRows) - nosOfColumn) + 1].toString() + ')'; return color; }
                    else if ((i % nosOfColumn) == (nosOfColumn - 1)) { color = 'rgb(' + globalPixelDataUpdate[i + 1].toString() + ')'; return color; }
                    else { color = 'rgb(' + globalPixelDataUpdate[nosOfColumn + 1 + i].toString() + ')'; return color; }
                    //d3.select(this).style('fill', "white");	
                });
            }

            var animateDesignDiagonaLeftUp = function () {
                nosOfColumn = parseInt(orderOfUpdatedMatrix[1]);
                nosOfRows = parseInt(orderOfUpdatedMatrix[0]);
                colorsOfElementUpdated();
                d3.selectAll("#designView rect").style("fill", function (d, i) {
                    //console.log(i);
                    //console.log(globalPixelDataUpdate[i + 1]);
                    // var plusOne = i + 1; 
                    //var specialCase = i - nosOfColumn + 1; 
                    var color;
                    if (i == (nosOfRows * nosOfColumn) - nosOfColumn) { color = 'rgb(' + globalPixelDataUpdate[nosOfColumn - 1].toString() + ')'; return color; }
                    else if (i > ((nosOfColumn * nosOfRows) - nosOfColumn)) { color = 'rgb(' + globalPixelDataUpdate[i - ((nosOfColumn * nosOfRows) - nosOfColumn) - 1].toString() + ')'; return color; }
                    else if ((i % nosOfColumn) == 0) { color = 'rgb(' + globalPixelDataUpdate[i + (2 * nosOfColumn) - 1].toString() + ')'; return color; }
                    else { /*console.log(nosOfColumn + 1 + i);*/ color = 'rgb(' + globalPixelDataUpdate[nosOfColumn - 1 + i].toString() + ')'; return color; }
                    //d3.select(this).style('fill', "white");	
                });
            }

            var animateDesignDiagonalLeftDown = function () {
                nosOfColumn = parseInt(orderOfUpdatedMatrix[1]);
                nosOfRows = parseInt(orderOfUpdatedMatrix[0]);
                colorsOfElementUpdated();
                d3.selectAll("#designView rect").style("fill", function (d, i) {
                    //console.log(i);
                    //console.log(globalPixelDataUpdate[i + 1]);
                    // var plusOne = i + 1; 
                    //var specialCase = i - nosOfColumn + 1; 
                    var color;
                    if (i == 0) { color = 'rgb(' + globalPixelDataUpdate[(nosOfColumn * nosOfRows) - 1].toString() + ')'; return color; }
                    else if (i <= (nosOfColumn - 1)) { color = 'rgb(' + globalPixelDataUpdate[i + ((nosOfColumn * nosOfRows) - nosOfColumn) - 1].toString() + ')'; return color; }
                    else if (i % (nosOfColumn) == 0) { color = 'rgb(' + globalPixelDataUpdate[i - 1].toString() + ')'; return color; }
                    else { /*console.log(nosOfColumn + 1 + i);*/ color = 'rgb(' + globalPixelDataUpdate[i - nosOfColumn - 1].toString() + ')'; return color; }
                    //d3.select(this).style('fill', "white");
                });
            }

            var animateDesignDiagonalRightDown = function () {
                nosOfColumn = parseInt(orderOfUpdatedMatrix[1]);
                nosOfRows = parseInt(orderOfUpdatedMatrix[0]);
                colorsOfElementUpdated();
                d3.selectAll("#designView rect").style("fill", function (d, i) {
                    //console.log(i);
                    //console.log(globalPixelDataUpdate[i + 1]);
                    // var plusOne = i + 1; 
                    //var specialCase = i - nosOfColumn + 1; 
                    var color;
                    if (i == (nosOfColumn) - 1) { color = 'rgb(' + globalPixelDataUpdate[(nosOfColumn * nosOfRows) - nosOfColumn].toString() + ')'; return color; }
                    else if (i <= (nosOfColumn - 2)) { color = 'rgb(' + globalPixelDataUpdate[i + ((nosOfColumn * nosOfRows) - nosOfColumn) + 1].toString() + ')'; return color; }
                    else if (i % (nosOfColumn) == (nosOfColumn - 1)) { color = 'rgb(' + globalPixelDataUpdate[i - (2 * nosOfColumn) + 1].toString() + ')'; return color; }
                    else { /*console.log(nosOfColumn + 1 + i);*/ color = 'rgb(' + globalPixelDataUpdate[i - (nosOfColumn - 1)].toString() + ')'; return color; }
                    //d3.select(this).style('fill', "white");
                });
            }

            var animateDesignUpLeftDownRight = function () {
                nosOfColumn = parseInt(orderOfUpdatedMatrix[1]);
                nosOfRows = parseInt(orderOfUpdatedMatrix[0]);
                colorsOfElementUpdated();
                d3.selectAll("#designView rect").style("fill", function (d, i) {
                    //console.log(i);
                    //console.log(globalPixelDataUpdate[i + 1]);
                    // var plusOne = i + 1; 
                    //var specialCase = i - nosOfColumn + 1; 
                    var color;
                    if (i < ((nosOfColumn * nosOfRows) / 2))
                        if ((i % (nosOfColumn)) == ((nosOfColumn) - 1)) { color = 'rgb(' + globalPixelDataUpdate[i - (nosOfColumn) + 1].toString() + ')'; /*console.log(color);*/ return color; }
                        else { color = 'rgb(' + globalPixelDataUpdate[i + 1].toString() + ')'; return color; }
                    else
                        if (i % parseInt(nosOfColumn) == 0) { color = 'rgb(' + globalPixelDataUpdate[i + parseInt(nosOfColumn) - 1].toString() + ')'; return color; }
                        else { color = 'rgb(' + globalPixelDataUpdate[i - 1].toString() + ')'; return color; }

                });
            }

            var animateDesignUpRightDownLeft = function () {
                nosOfColumn = parseInt(orderOfUpdatedMatrix[1]);
                nosOfRows = parseInt(orderOfUpdatedMatrix[0]);
                colorsOfElementUpdated();
                d3.selectAll("#designView rect").style("fill", function (d, i) {
                    //console.log(i);
                    //console.log(globalPixelDataUpdate[i + 1]);
                    // var plusOne = i + 1; 
                    //var specialCase = i - nosOfColumn + 1; 
                    var color;
                    if (i >= ((nosOfColumn * nosOfRows) / 2))
                        if ((i % (nosOfColumn)) == ((nosOfColumn) - 1)) { color = 'rgb(' + globalPixelDataUpdate[i - (nosOfColumn) + 1].toString() + ')'; /*console.log(color);*/ return color; }
                        else { color = 'rgb(' + globalPixelDataUpdate[i + 1].toString() + ')'; return color; }
                    else
                        if (i % parseInt(nosOfColumn) == 0) { color = 'rgb(' + globalPixelDataUpdate[i + parseInt(nosOfColumn) - 1].toString() + ')'; return color; }
                        else { color = 'rgb(' + globalPixelDataUpdate[i - 1].toString() + ')'; return color; }

                });
            }

            var animateDesignLeftUpRightDown = function () {
                nosOfColumn = parseInt(orderOfUpdatedMatrix[1]);
                nosOfRows = parseInt(orderOfUpdatedMatrix[0]);

                colorsOfElementUpdated();
                d3.selectAll("#designView rect").style("fill", function (d, i) {
                    //console.log(i);
                    //console.log(globalPixelDataUpdate[i + 1]);
                    // var plusOne = i + 1; 
                    //var specialCase = i - nosOfColumn + 1; 
                    var color;
                    valueOfx = i % nosOfColumn;
                    if (valueOfx < (nosOfColumn / 2))
                        if (i >= ((nosOfColumn * nosOfRows) - nosOfColumn)) { color = 'rgb(' + globalPixelDataUpdate[i - ((nosOfColumn * nosOfRows) - nosOfColumn)].toString() + ')'; return color; }
                        else { color = 'rgb(' + globalPixelDataUpdate[i + nosOfColumn].toString() + ')'; return color; }
                    else
                        if (i < nosOfColumn) { color = 'rgb(' + globalPixelDataUpdate[i + ((nosOfColumn * nosOfRows) - nosOfColumn)].toString() + ')'; return color; }
                        else { color = 'rgb(' + globalPixelDataUpdate[i - nosOfColumn].toString() + ')'; return color; }

                });
            }

            var animateDesignLeftDownRightUp = function (elapsed) {
                nosOfColumn = parseInt(orderOfUpdatedMatrix[1]);
                nosOfRows = parseInt(orderOfUpdatedMatrix[0]);
                colorsOfElementUpdated();
                d3.selectAll("#designView rect").style("fill", function (d, i) {
                    //console.log(i);
                    //console.log(globalPixelDataUpdate[i + 1]);
                    // var plusOne = i + 1; 
                    //var specialCase = i - nosOfColumn + 1; 
                    var color;
                    valueOfx = i % nosOfColumn;
                    if (valueOfx >= (nosOfColumn / 2))
                        if (i >= ((nosOfColumn * nosOfRows) - nosOfColumn)) { color = 'rgb(' + globalPixelDataUpdate[i - ((nosOfColumn * nosOfRows) - nosOfColumn)].toString() + ')'; return color; }
                        else { color = 'rgb(' + globalPixelDataUpdate[i + nosOfColumn].toString() + ')'; return color; }
                    else
                        if (i < nosOfColumn) { color = 'rgb(' + globalPixelDataUpdate[i + ((nosOfColumn * nosOfRows) - nosOfColumn)].toString() + ')'; return color; }
                        else { color = 'rgb(' + globalPixelDataUpdate[i - nosOfColumn].toString() + ')'; return color; }

                });
            }

            var continueAnimation = null;

            var animateRepeat = function (frames) {
                //console.log("hey!");
                //d3.timer();
                //if(stop == 1){ console.log(speed);clearInterval(startAnimation);}
                //var startAnimation = setTimeout(animateDesignLeftDownRightUp, speed);
                var selectValue = parseInt(d3.select('#nRadius').property('value'));
                var partTwo;
                console.log("speed", selectValue);
                var interval = 4 * (selectValue * frames) + 100; console.log("total time", interval);
                animationsToBeLoaded(frames, selectValue, partTwo);
                continueAnimation = setInterval(function () {
                    animationsToBeLoaded(frames, selectValue, partTwo);
                }, interval);
                //
            }



            function myStopFunction() {
                //console.log(continueAnimation);
                clearInterval(continueAnimation); continueAnimation = null; console.log("Yep");
            }


            var animationsToBeLoaded = function (frames, selectValue, partTwo) {
                for (var i = 0; i < frames; i++) {
                    setTimeout(animateDesignLeft, i * selectValue);
                }
                partTwo = 0;
                partTwo = partTwo + selectValue + i * selectValue; console.log("part 2", partTwo);
                for (var i = 0; i < frames; i++) {
                    setTimeout(animateDesignUp, ((i * selectValue) + partTwo));
                }
                partTwo = partTwo + selectValue + i * selectValue; console.log("part 2", partTwo);
                for (var i = 0; i < frames; i++) {
                    setTimeout(animateDesignRight, ((i * selectValue) + partTwo));
                }
                partTwo = partTwo + selectValue + i * selectValue; console.log("part 2", partTwo);
                for (var i = 0; i < frames; i++) {
                    setTimeout(animateDesignDown, ((i * selectValue) + partTwo));
                }
            }


            /************************/
            
            var dataAnimations = ["animateDesignLeft", "animateDesignRight", "animateDesignUp", "animateDesignDown", "animateDesignDiagonalRightUp", "animateDesignDiagonaLeftUp", "animateDesignDiagonalLeftDown", "animateDesignDiagonalRightDown", "animateDesignUpLeftDownRight", "animateDesignUpRightDownLeft", "animateDesignLeftUpRightDown", "animateDesignLeftDownRightUp"];

            var dataAnimationsVar = d3.select('#animationsMenu')
                .append('select')
                .attr('class', 'select');


            /*var dataAnimationsOptions = dataAnimationsVar
                .selectAll('option')
                .data(dataAnimations).enter()
                .append('option')
                .text(function (d) { return d; });
            /***/

            var framesData = [];

            framesDataFunc = function () {
                var tempFramesData = []
                for (i = 1; i <= 50; i++) {
                    tempFramesData.push(i);
                    //console.log(tempRowData);
                }

                return tempFramesData;
            }

            framesData = framesDataFunc();

            var numberOfFrames = d3.select('#numberOfFrames')
                .append('select')
                .attr('class', 'select');


            /*var totalFrames = numberOfFrames.selectAll('option')
                .data(framesData)
                .enter().append('option')
                .text(function (d) { return d; });


            /***/

            var nameDesAnimationsVar = d3.select('#nameOfDesigninFrame')
                .append('select')
                .attr('class', 'select');

            /***/	

            var timeForAnimationsVar = d3.select('#timeForNxtFrame')
                .append('select')
                .attr('class', 'select');

            speedSetData = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];

            /****/

            var animationFrameNumber = 1;

            var tempAnimationData = [];

            var globalAnimationFile = [];
            function addAFrame() {
                globalAnimationFile = [];

                

                var theNameLoaded = '#animationsMenu' + ' #newAnimation' + 1;

                var theFramesLoaded = '#numberOfFrames' + ' #frameNumber' + 1;

                var designOnAnimationLoaded = '#nameOfDesigninFrame' + ' #designInFrame' + 1;

                var timeOfTheFrameChangeLoaded = '#timeForNxtFrame' + ' #timeForChange' + 1;


                var theName = 'newAnimation' + animationFrameNumber;

                var theFrame = 'frameNumber' + animationFrameNumber;

                var designOnAnimation = 'designInFrame' + animationFrameNumber;

                var timeOfTheFrameChange = 'timeForChange' + animationFrameNumber;

                nosOfFrames = d3.select('#numberOfFrames select').property('value');
                theAnimation = d3.select('#animationsMenu select').property('value');
                //console.log("Frames", nosOfFrames);
                //console.log("Animations", theAnimation);
                //console.log("Frames Data", framesData);	
                //totalFrames;

                var nameOfDesignLoaded = d3.select('#designFromDb').property('value');	

                var nameDesignString = [nameOfDesignLoaded.toString()]; 

                /**Nos Of Frames Option**/
                var numberOfFrames = d3.select('#numberOfFrames')
                    .append('select')
                    .attr('class', 'select')
                    .attr("id", function () { return theFrame; });

                var totalFrames = numberOfFrames
                    .selectAll('option')
                    .data(framesData).enter()
                    .append('option')
                    .text(function (d) { return d; });

                /**Name of frame Option**/
                var dataAnimationsVar = d3.select('#animationsMenu')
                    .append('select')
                    .attr('class', 'select')
                    .attr("id", function () { return theName; });


                var dataAnimationsOptions = dataAnimationsVar
                    .selectAll('option')
                    .data(dataAnimations).enter()
                    .append('option')
                    .text(function (d) { return d; });


                /**Name Of Design**/
                var nameDesAnimationsVar = d3.select('#nameOfDesigninFrame')
                .append('select')
                .attr('class', 'select')
                .attr("id", function () { return designOnAnimation; });

                var nameDesAnimationsOptions = nameDesAnimationsVar
                    .selectAll('option')
                    .data(nameDesignString).enter()
                    .append('option')
                    .text(function (d) { return d; });

                
                /**Time**/
                var timeForAnimationsVar = d3.select('#timeForNxtFrame')
                                             .append('select')
                                                .attr('class', 'select')
                                                .attr("id", function () { return timeOfTheFrameChange; });

                var timeForAnimationsOptions = timeForAnimationsVar
                    .selectAll('option')
                    .data(speedSetData).enter()
                    .append('option')
                    .text(function (d) { return d; });	
                
                /***/
                var nameOfAnimation = d3.select(theNameLoaded).property('value');
                var nosOfFrames = d3.select(theFramesLoaded).property('value');
                var nameOfDesignForAni = d3.select(designOnAnimationLoaded).property('value');
                var timeForFrame = 	d3.select(timeOfTheFrameChangeLoaded).property('value');
                //Name Of Animation
                console.log("name of animation", nameOfAnimation); 

                //Number of frames of the Animation
                console.log("number of frames", nosOfFrames); globalAnimationFile.push(nosOfFrames);


                //Name Of Design
                console.log("name of design", nameOfDesignForAni); globalAnimationFile.push(nameOfDesignForAni);

                //Time
                console.log("time", timeForFrame); globalAnimationFile.push(timeForFrame);

                animationFrameNumber++;

                /*colorsOfElementUpdated();
                tempAnimationData.push(globalPixelDataUpdate);
                console.log(globalPixelDataUpdate);
                console.log(tempAnimationData[0]);

                    console.log(tempAnimationData[tempAnimationData.length - 1])*/
                
                //This counter Increases the id Nos. for any animation created.
                //console.log(animationFrameNumber);

                //This stores the name of design
                //console.log(nameOfDesignLoaded); globalAnimationFile.push(nameOfDesignLoaded);

                if (nameOfDesignLoaded === "") { alert("No Name Found!") }
                
                $("#addFrames").hide();	
                $("#addMe").show();
                //console.log(globalAnimationFile);
                /*d3.xhr('http://192.168.2.8:8080/api/animations/')
                .header("Content-Type", "application/json")
                .post(
                    JSON.stringify({
                        animation:[nameOfDesignLoaded, nameOfAnimation, nosOfFrames]  
                    })
                );
                alert("Save");*/
            }

            $(document).ready(function(){
                $("#addMe").hide();
            });


        var addMeFunc = function(){

            //console.log(animationFrameNumber-1);

            theNameLoaded = '#animationsMenu' + ' #newAnimation' + (animationFrameNumber-1).toString();
            theFramesLoaded = '#numberOfFrames' + ' #frameNumber' + (animationFrameNumber-1).toString();
            timeOfTheFrameChangeLoaded = '#timeForNxtFrame' + ' #timeForChange' + animationFrameNumber - (animationFrameNumber-1).toString();
            
            
            nosOfFrames = d3.select(theFramesLoaded).property('value');
            nameOfAnimation = d3.select(theNameLoaded).property('value') ;

            console.log(nosOfFrames);
            console.log(nameOfAnimation);
        
            //Done to stop pollutiong the temp file
            $("#addMe").hide(); 
            $("#addFrames").show();
            
                console.log("Animation frame Number", animationFrameNumber);
                if(animationFrameNumber -1 == 1){
                            
                        colorsOfElementUpdated();
                        tempAnimationData.push(globalPixelDataUpdate);	
                }

            for(var i = 1; i <= nosOfFrames; i++){
                eval(nameOfAnimation.toString()).call();
                colorsOfElementUpdated();
                tempAnimationData.push(globalPixelDataUpdate);
                //console.log(tempAnimationData[tempAnimationData.length - 1]);
                console.log(tempAnimationData.length);
            
            }

        }	

        var allAnimationFDesign = [];

        var showMeFunc = function(){
            console.log("Animation Frame Number", animationFrameNumber);
            var  designOnAnimationLoaded; 
            var q = d3.queue(1);
            var urlOfDesign;	
            for(var listOfDesign = 1; listOfDesign < animationFrameNumber; listOfDesign++){
                designOnAnimationLoaded = '#nameOfDesigninFrame' + ' #designInFrame' + listOfDesign;
                console.log(designOnAnimationLoaded);
                urlOfDesign = "http://localhost:8080/api/todos/text/" + d3.select(designOnAnimationLoaded).property('value');
                console.log(urlOfDesign);
                q.defer(d3.json, urlOfDesign)
            }				
                    /*q
                    .defer(d3.json, "http://localhost:8080/api/todos/text/1,14")
                    .defer(d3.json, "http://localhost:8080/api/todos/text/16,16")
                    .defer(d3.json, "http://localhost:8080/api/todos/text/4,4")
                    .awaitAll(ready);*/
                    q.awaitAll(ready);
            

        }	

        function ready(error, data){
                console.log(data[0][0]["pixel"]);
        }

        var removeLastFrame = function(){
            //console.log(d3.select('#animationsMenu #newAnimation1').property('value'));	
            
            //console.log(animationFrameNumber);
            $("#addMe").hide();
            $("#addFrames").show();
            animationFrameNumber--;	
            
            var animationRemove = '#animationsMenu #newAnimation' + animationFrameNumber;
            
            var numberFramesRemove = '#numberOfFrames #frameNumber' + animationFrameNumber;

            var designNameRemove  = '#nameOfDesigninFrame #designInFrame' + animationFrameNumber;

            var timeForFrameRemove =  '#timeForNxtFrame #timeForChange' + animationFrameNumber;

            d3.select(animationRemove).remove();
            d3.select(numberFramesRemove).remove();
            d3.select(designNameRemove ).remove();
            d3.select(timeForFrameRemove).remove();	
            tempAnimationData.pop();
            console.log("length ", tempAnimationData.length);
        }	

        var createAnimation = function(){
            
            var animationData = [];

            var theNameLoaded, theFramesLoaded, designOnAnimationLoaded, timeOfTheFrameChangeLoaded; 

            var nameOfAnimation, nosOfFrames, nameOfDesignForAni, timeForFrame;

            var nameForThisAnimation = document.getElementById("nameOfAnimation").value;

            for(var i = 1; i < animationFrameNumber; i++)
                {
                    theNameLoaded = '#animationsMenu' + ' #newAnimation' + i;
                    theFramesLoaded = '#numberOfFrames' + ' #frameNumber' + i;
                    designOnAnimationLoaded = '#nameOfDesigninFrame' + ' #designInFrame' + i;
                    timeOfTheFrameChangeLoaded = '#timeForNxtFrame' + ' #timeForChange' + i;
                    


                    nameOfAnimation = d3.select(theNameLoaded).property('value');
                    animationData.push(nameOfAnimation);	

                    nosOfFrames = d3.select(theFramesLoaded).property('value');
                    animationData.push(nosOfFrames);

                    nameOfDesignForAni = d3.select(designOnAnimationLoaded).property('value');
                    animationData.push(nameOfDesignForAni);

                    timeForFrame = 	d3.select(timeOfTheFrameChangeLoaded).property('value');
                    animationData.push(timeForFrame);

                    console.log(nameOfAnimation, nosOfFrames, nameOfDesignForAni, timeForFrame);
                }
            
                console.log(animationData); console.log(nameForThisAnimation);

                d3.xhr('http://localhost:8080/api/animation/')
                .header("Content-Type", "application/json")
                .post(
                    JSON.stringify({
                        name: nameForThisAnimation,
                        animation: animationData  
                    })
                );
        } 

        var getAnimationFromDb = function (){
            var animationObject = {};
            var arrayAnimationData = [];
            var animToBeDone = [];
            var designAnimRequire = [];
            var framesItWillMove = [];
            var timeOfAFrame = [];  
            var nameOfAnimationLoaded = d3.select('#animationFromDb').property('value');	
            var nameAnimationString = [nameOfAnimationLoaded.toString()];
            console.log(nameAnimationString); 
            urlForAnimation = 'http://localhost:8080/api/animation/name/' + nameOfAnimationLoaded.toString(); 
            var request = new XMLHttpRequest();
            request.open('GET', urlForAnimation, false);  // `false` makes the request synchronous	
            request.send(null);
            

            if (request.status === 200) {
                  
                    animationObject = JSON.parse(request.responseText); 
            }	

            arrayAnimationData = animationObject[0] ["animation"];
            for(var i = 0; i <= arrayAnimationData.length - 1; i += 4){

                animToBeDone.push(arrayAnimationData[i]);
                designAnimRequire.push(arrayAnimationData[i + 2]);
                framesItWillMove.push(arrayAnimationData[i + 1]);
                timeOfAFrame.push(arrayAnimationData[i + 3]);
            }

            console.log("Animation ", animToBeDone,"Name of Design ", designAnimRequire,"Nos. of frames ", framesItWillMove, "Time ", timeOfAFrame);
        }
        
        
        var AnimationSearchDD = d3.select('#getAnimationFromDb')
                .append('select')
                .attr('class', 'select')
                .attr('size', 5)
                .attr('id', 'animationFromDb');
            //.on("click", function(){console.log("Yep Hit Me!"); nameOfTheDesign();});	

        var animationDDmenuTitle = ["Look For Your Animation"];

            var optionsAnimationsSaved = AnimationSearchDD
                .selectAll('option')
                .data(animationDDmenuTitle).enter()
                .append('option')
                .text(function (d) { return d; });	
        
        var retriveAnimationNames = function(){
            
            var animationNamesFromdb = [];
            d3.selectAll("#getAnimationFromDb option").remove();
                d3.json("http://localhost:8080/api/animation", function (error, data, i) {
                    animationNamesFromdb = [];
                    for (var i = 0; i < data.length; i++) {
                        var animationSaved = animationNamesFromdb.push(data[i]["name"]);
                    }
                    AnimationSearchDD.selectAll('option')
                        .data(animationNamesFromdb).enter()
                        .append('option').sort(d3.ascending)
                        .text(function (d) { return d; })
                        .on("click", function () { nameOfTheAnimation = d3.select(this).property('value'); console.log(nameOfTheAnimation);});
                });
        }

        var processAnimationFile = function(){
            console.log("Yay you hit me!");
            var arrayAnimationData = [];
            var animToBeDone = [];
            var designAnimRequire = [];
            var framesItWillMove = [];
            var timeOfAFrame = [];
            var nameOfAnimationLoaded = d3.select('#animationFromDb').property('value');	
            var nameAnimationString = [nameOfAnimationLoaded.toString()];
            var urlOfAnimation = "http://localhost:8080/api/animation/name/" + nameAnimationString;  
            pixelsFrameByFrame = [];
            d3.json(urlOfAnimation, function(data){
                console.log(data[0]["animation"]);
                
            arrayAnimationData = data[0]["animation"];
            for(var i = 0; i <= arrayAnimationData.length - 1; i += 4){

                animToBeDone.push(arrayAnimationData[i]);
                designAnimRequire.push(arrayAnimationData[i + 2]);
                framesItWillMove.push(arrayAnimationData[i + 1]);
                timeOfAFrame.push(arrayAnimationData[i + 3]);
            }

            console.log("Animation ", animToBeDone,"Name of Design ", designAnimRequire,"Nos. of frames ", framesItWillMove, "Time ", timeOfAFrame);
            for(var theAnimationIterator = 0; theAnimationIterator <= designAnimRequire.length -1; theAnimationIterator++){
                        urlOfDesign = 'http://localhost:8080/api/todos/text/' + designAnimRequire[theAnimationIterator];
                        counterRaise = 0;
                        d3.json(urlOfDesign, function(d){
                        if(counterRaise == 0){
                            console.log("Yep Zero");
                        }
                        console.log("The Iterator", counterRaise);
                        animatedPixelGenrator(d[0]["order"], d[0]["pixel"], animToBeDone[counterRaise], framesItWillMove[counterRaise]);
                        counterRaise++;
                    });
                }
            });
        }

        function animatedPixelGenrator(matrixOrder, pixel, animToBeDone, framesItWillMove){
            var pixelAnimationData = [];
            var currentPixelData = 	[];
            if(animToBeDone === "Left"){
                for(var i = 1; i <= framesItWillMove; i++){
                    console.log("The Animation Performed is " + animToBeDone);
                    //processLeft(matrixOrder, pixel);
                }
                
            }
            else if(animToBeDone === "Right"){
                for(var i = 1; i <= framesItWillMove; i++){
                    console.log("The Animation Performed is " + animToBeDone);
                }
            }
            else if(animToBeDone === "Up"){
                for(var i = 1; i <= framesItWillMove; i++){
                    console.log("The Animation Performed is " + animToBeDone);
                }
            }
            else if(animToBeDone === "Down"){
                for(var i = 1; i <= framesItWillMove; i++){
                    console.log("The Animation Performed is " + animToBeDone);
                }
            }
            else if(animToBeDone === "Digonal Left Up"){
                for(var i = 1; i <= framesItWillMove; i++){
                    console.log("The Animation Performed is " + animToBeDone);
                }
            }
            else if(animToBeDone === "Digonal Right Up"){
                for(var i = 1; i <= framesItWillMove; i++){
                    console.log("The Animation Performed is " + animToBeDone);
                }
            }
            else if(animToBeDone === "Digonal Left Down"){
                for(var i = 1; i <= framesItWillMove; i++){
                    console.log("The Animation Performed is " + animToBeDone);
                }
            }
            else if(animToBeDone === "Digonal Right Down"){
                for(var i = 1; i <= framesItWillMove; i++){
                    console.log("The Animation Performed is " + animToBeDone);
                }
            }
            else if(animToBeDone === "Half Left"){
                for(var i = 1; i <= framesItWillMove; i++){
                    console.log("The Animation Performed is " + animToBeDone);
                }	
            }
            else if(animToBeDone === "Half Right"){
                for(var i = 1; i <= framesItWillMove; i++){
                    console.log("The Animation Performed is " + animToBeDone);
                }
            }
            else if(animToBeDone === "Half Up"){
                for(var i = 1; i <= framesItWillMove; i++){
                    console.log("The Animation Performed is " + animToBeDone);
                }
            }
            else if(animToBeDone === "Half Down"){
                for(var i = 1; i <= framesItWillMove; i++){
                    console.log("The Animation Performed is " + animToBeDone);
                }
            }	
        }

    var processLeft = function(order, pixel){
        console.log(pixel);
        

    }	

    var playAnimation =function(){
        
        var theNameLoaded, theFramesLoaded, designOnAnimationLoaded, timeOfTheFrameChangeLoaded, pdesignOnAnimationLoaded; 

        var nameOfAnimation, nosOfFrames, nameOfDesignForAni, timeForFrame, pnameOfDesignForAni;

        var nameForThisAnimation = document.getElementById("nameOfAnimation").value;

        for(let i = 1; i < animationFrameNumber; i++)
        {
            theNameLoaded = '#animationsMenu' + ' #newAnimation' + i;
            theFramesLoaded = '#numberOfFrames' + ' #frameNumber' + i;
            designOnAnimationLoaded = '#nameOfDesigninFrame' + ' #designInFrame' + i;
            timeOfTheFrameChangeLoaded = '#timeForNxtFrame' + ' #timeForChange' + i;
            //pdesignOnAnimationLoaded = '#nameOfDesigninFrame' + ' #designInFrame' + i;
            
            //console.log(nameOfAnimation);	

            
            //console.log(nosOfFrames);

            nameOfDesignForAni = d3.select(designOnAnimationLoaded).property('value');
            //pnameOfDesignForAni = d3.select(designOnAnimationLoaded).property('value');

            //console.log(nameOfDesignForAni);
            //console.log(pnameOfDesignForAni);

            if( i-1 > 0){
                console.log("Did enter this");
                var indexOfData = i - 1;
                pdesignOnAnimationLoaded = '#nameOfDesigninFrame' + ' #designInFrame' + indexOfData;
                pnameOfDesignForAni = d3.select(pdesignOnAnimationLoaded).property('value');	
                console.log("Previous Design", pnameOfDesignForAni);
            }
            
            //console.log(timeForFrame);

            urlForDesign = 'http://localhost:8080/api/todos/text/' + nameOfDesignForAni;

            //console.log(urlForDesign); 
            var countI = 1;

            if(i == 1 || pnameOfDesignForAni != nameOfDesignForAni){

            d3.json(urlForDesign, function(data){
                //console.log(animationFrameNumber);
                console.log("Count I",typeof(countI.toString()));

                theNameLoaded = '#animationsMenu' + ' #newAnimation' + countI;
                theFramesLoaded = '#numberOfFrames' + ' #frameNumber' + countI;
                timeOfTheFrameChangeLoaded = '#timeForNxtFrame' + ' #timeForChange' + countI;
                
                nosOfFrames = d3.select(theFramesLoaded).property('value');
                timeForFrame = 	d3.select(timeOfTheFrameChangeLoaded).property('value');
                nameOfAnimation = d3.select(theNameLoaded).property('value') + '()';
                console.log(nameOfAnimation);	


                d3.selectAll("#designView rect").remove();
                var orderOfUpdatedMatrix = data[0]["order"]
                    var nosOfRows = data[0]["order"][0];
                    var nosOfColumn = data[0]["order"][1];
                    var pixelInfo = data[0]["pixel"];
                    //console.log(nosOfRows, nosOfColumn, pixelInfo);
                    designsvg.selectAll("#designView")
                        .data(pixelInfo).enter()
                        .append("rect")
                        .attr("x", function (d, i) { valueOfx = i % nosOfColumn; return valueOfx * 15; })
                        .attr("y", function (d, i) { valueOfy = Math.floor(i / nosOfColumn); return valueOfy * 15; })
                        .attr("width", 14)
                        .attr("height", 14).style('fill', function (d, i) {
                            //console.log(d.toString());
                            rgbValue = "rgb(" + d.toString() + ")";
                            return rgbValue;
                        })
                        .style('stroke-width', 0.7).style('stroke', "black")
                        .on("click", function (d) { d3.select(this).style('fill', function () { var color = onchangeColor(); return color; }); })
                        .on("mousedown", function (d) {

                            var div = d3.select(this)
                                .classed("active", true);
                            var wEdit = d3.selectAll("#designView rect")
                                .on("mousemove", mousemoveEdit)
                                .on("mouseup", mouseupEdit);


                            d3.event.preventDefault(); // disable text dragging
                            function mousemoveEdit() {
                                d3.select(this).style('fill', function () { var color = onchangeColor(); return color; });
                            }


                            function mouseupEdit() {
                                div.classed("active", false);
                                wEdit.on("mousemove", null).on("mouseup", null);
                            }

                        })
                        .on("dblclick", function (d) { d3.select(this).style('fill', "white"); onchangeColor(); }); 
                        //console.log("Frames", nosOfFrames);
                        //console.log("Time", timeForFrame);
                        
                        for(var i = 0; i < nosOfFrames; i++){
                        
                            setTimeout(nameOfAnimation, (200+((i-1)*10*timeForFrame)));
        
                        }
                        countI++;
                        //console.log(countI);
                            
                });
            }
            else if(pnameOfDesignForAni == nameOfDesignForAni){
                console.log("Yes The Name is Same!");

                nosOfFrames = d3.select(theFramesLoaded).property('value');
                timeForFrame = 	d3.select(timeOfTheFrameChangeLoaded).property('value');
                nameOfAnimation = d3.select(theNameLoaded).property('value') + '()';
                console.log(nosOfFrames, timeForFrame, nameOfAnimation);
                /*for(var iRepeat = 0; iRepeat < nosOfFrames; i++){
                        
                        setTimeout(nameOfAnimation, (2000+((iRepeat-1)*10*timeForFrame)));
    
                    }*/
            }
            else{
                console.log("Didn't catch anything");
            }
        }
    }





    var alternatePlayAnimation =function(){
        
        var theNameLoaded, theFramesLoaded, designOnAnimationLoaded, timeOfTheFrameChangeLoaded, pdesignOnAnimationLoaded; 

        var nameOfAnimation, nosOfFrames, nameOfDesignForAni, timeForFrame, pnameOfDesignForAni;

        var nameForThisAnimation = document.getElementById("nameOfAnimation").value;

        for(let i = 1; i < animationFrameNumber; i++)
        {
            theNameLoaded = '#animationsMenu' + ' #newAnimation' + i;
            theFramesLoaded = '#numberOfFrames' + ' #frameNumber' + i;
            designOnAnimationLoaded = '#nameOfDesigninFrame' + ' #designInFrame' + i;
            timeOfTheFrameChangeLoaded = '#timeForNxtFrame' + ' #timeForChange' + i;
            //pdesignOnAnimationLoaded = '#nameOfDesigninFrame' + ' #designInFrame' + i;
            
            //console.log(nameOfAnimation);	

            
            //console.log(nosOfFrames);

            nameOfDesignForAni = d3.select(designOnAnimationLoaded).property('value');
            //pnameOfDesignForAni = d3.select(designOnAnimationLoaded).property('value');

            //console.log(nameOfDesignForAni);
            //console.log(pnameOfDesignForAni);

            
            
            //console.log(timeForFrame);

            urlForDesign = 'http://localhost:8080/api/todos/text/' + nameOfDesignForAni;

            //console.log(urlForDesign); 
            var countI = i;

            

            d3.json(urlForDesign, function(data){
                console.log("the I", i);
                console.log("Count I",countI.toString());

                theNameLoaded = '#animationsMenu' + ' #newAnimation' + countI;
                theFramesLoaded = '#numberOfFrames' + ' #frameNumber' + countI;
                timeOfTheFrameChangeLoaded = '#timeForNxtFrame' + ' #timeForChange' + countI;
                
                nosOfFrames = d3.select(theFramesLoaded).property('value');
                timeForFrame = 	d3.select(timeOfTheFrameChangeLoaded).property('value');
                nameOfAnimation = d3.select(theNameLoaded).property('value') + '()';
                console.log(nameOfAnimation);	


                d3.selectAll("#designView rect").remove();
                var orderOfUpdatedMatrix = data[0]["order"]
                    var nosOfRows = data[0]["order"][0];
                    var nosOfColumn = data[0]["order"][1];
                    var pixelInfo = data[0]["pixel"];
                    //console.log(nosOfRows, nosOfColumn, pixelInfo);
                    designsvg.selectAll("#designView")
                        .data(pixelInfo).enter()
                        .append("rect")
                        .attr("x", function (d, i) { valueOfx = i % nosOfColumn; return valueOfx * 15; })
                        .attr("y", function (d, i) { valueOfy = Math.floor(i / nosOfColumn); return valueOfy * 15; })
                        .attr("width", 14)
                        .attr("height", 14).style('fill', function (d, i) {
                            //console.log(d.toString());
                            rgbValue = "rgb(" + d.toString() + ")";
                            return rgbValue;
                        })
                        .style('stroke-width', 0.7).style('stroke', "black")
                        .on("click", function (d) { d3.select(this).style('fill', function () { var color = onchangeColor(); return color; }); })
                        .on("mousedown", function (d) {

                            var div = d3.select(this)
                                .classed("active", true);
                            var wEdit = d3.selectAll("#designView rect")
                                .on("mousemove", mousemoveEdit)
                                .on("mouseup", mouseupEdit);


                            d3.event.preventDefault(); // disable text dragging
                            function mousemoveEdit() {
                                d3.select(this).style('fill', function () { var color = onchangeColor(); return color; });
                            }


                            function mouseupEdit() {
                                div.classed("active", false);
                                wEdit.on("mousemove", null).on("mouseup", null);
                            }

                        })
                        .on("dblclick", function (d) { d3.select(this).style('fill', "white"); onchangeColor(); }); 
                        //console.log("Frames", nosOfFrames);
                        //console.log("Time", timeForFrame);
                        
                        for(var i = 0; i < nosOfFrames; i++){
                        
                            setTimeout(nameOfAnimation, (200+((i-1)*10*timeForFrame)));
        
                        }
                        //countI++;
                        //i = 3;
                        //console.log(countI);
                            
                });
        
            
        }
    }

    var syncPlayAnimation = function(){

        var theNameLoaded, theFramesLoaded, designOnAnimationLoaded, timeOfTheFrameChangeLoaded, pdesignOnAnimationLoaded; 

        var nameOfAnimation, nosOfFrames, nameOfDesignForAni, timeForFrame, pnameOfDesignForAni;
        
        console.log("In The Function");

        for(var i = 1; i < animationFrameNumber; i++){
            console.log("In The Function Loop");
            theNameLoaded = '#animationsMenu' + ' #newAnimation' + i;
            theFramesLoaded = '#numberOfFrames' + ' #frameNumber' + i;
            designOnAnimationLoaded = '#nameOfDesigninFrame' + ' #designInFrame' + i;
            timeOfTheFrameChangeLoaded = '#timeForNxtFrame' + ' #timeForChange' + i;

            nameOfDesignForAni = d3.select(designOnAnimationLoaded).property('value');

            if( i-1 > 0){
                console.log("Did enter this");
                var indexOfData = i - 1;
                pdesignOnAnimationLoaded = '#nameOfDesigninFrame' + ' #designInFrame' + indexOfData;
                pnameOfDesignForAni = d3.select(pdesignOnAnimationLoaded).property('value');	
                console.log("Previous Design", pnameOfDesignForAni);
            }

            urlForDesign = 'http://localhost:8080/api/todos/text/' + nameOfDesignForAni.toString();
            
            if(i == 1 || pnameOfDesignForAni != nameOfDesignForAni){
                var request = new XMLHttpRequest();
                request.open('GET', urlForDesign, false);  // `false` makes the request synchronous	
                request.send(null);
                data = {};

                if (request.status === 200) {
                  
                    data = JSON.parse(request.responseText);
                    d3.selectAll("#designView rect").remove();
                    var orderOfUpdatedMatrix = data[0]["order"]
                    var nosOfRows = data[0]["order"][0];
                    var nosOfColumn = data[0]["order"][1];
                    var pixelInfo = data[0]["pixel"];
                    console.log(nosOfRows, nosOfColumn, pixelInfo);
                    designsvg.selectAll("#designView")
                        .data(pixelInfo).enter()
                        .append("rect")
                        .attr("x", function (d, i) { valueOfx = i % nosOfColumn; return valueOfx * 15; })
                        .attr("y", function (d, i) { valueOfy = Math.floor(i / nosOfColumn); return valueOfy * 15; })
                        .attr("width", 14)
                        .attr("height", 14).style('fill', function (d, i) {
                            //console.log(d.toString());
                            rgbValue = "rgb(" + d.toString() + ")"; console.log("hi");
                            return rgbValue;
                        })
                        .style('stroke-width', 0.7).style('stroke', "black")
                        .on("click", function (d) { d3.select(this).style('fill', function () { var color = onchangeColor(); return color; }); })
                        .on("mousedown", function (d) {

                            var div = d3.select(this)
                                .classed("active", true);
                            var wEdit = d3.selectAll("#designView rect")
                                .on("mousemove", mousemoveEdit)
                                .on("mouseup", mouseupEdit);


                            d3.event.preventDefault(); // disable text dragging
                            function mousemoveEdit() {
                                d3.select(this).style('fill', function () { var color = onchangeColor(); return color; });
                            }


                            function mouseupEdit() {
                                div.classed("active", false);
                                wEdit.on("mousemove", null).on("mouseup", null);
                            }

                        })
                        .on("dblclick", function (d) { d3.select(this).style('fill', "white"); onchangeColor(); }); 
                        for(var newi = 0; newi < nosOfFrames; newi++){
                        console.log("Did Set Time Out");
                        setTimeout(nameOfAnimation, (200+((newi-1)*10*timeForFrame)));
    
                    }
                 
                }

                
            }
            
            else{
                console.log("Oops!");
            }
        }
    }

    /*var generateTheCodeFunc = function(){
        var pixelString, pixelStringComplete;
        var programOutput = document.getElementById("programOutput"); 
        
        console.log(tempAnimationData.length - 1);
        for(var i = (tempAnimationData.length - 1); i >= 0; i--){
            programOutput.value = " pixels.show(); delay(700);"+programOutput.value;
            for(var j = (tempAnimationData[i].length - 1); j >= 0; j--){

            
                pixelString = "pixels.setPixelColor(" + j + ", pixels.Color(" + tempAnimationData[i][j].toString() + "));" + "\n";
                console.log(pixelString);
                programOutput.value = pixelString+programOutput.value;
                pixelStringComplete = pixelString + pixelStringComplete;
            }
        }
        
        
    }*/

    var generateTheCodeFunc = function(){
        var pixelString, pixelStringComplete;
        var programOutput = document.getElementById("programOutput"); 
        
        //console.log(tempAnimationData.length - 1);
        for(var i = (tempAnimationData.length - 1); i >= 0; i--){
            //programOutput.value = "};  decodeTheColor(data" + i + "); delay(700);" + '\n'+ programOutput.value;
            /*for(var j = (tempAnimationData[i].length - 1); j >= 0; j--){

                if(j == tempAnimationData[i].length - 1){
                    pixelString = "{" + tempAnimationData[i][j] + "}";
                }
                else{
                    pixelString = "{" + tempAnimationData[i][j] + "},";
                }
                //console.log(pixelString);
                programOutput.value = pixelString + programOutput.value;
                pixelStringComplete = pixelString + pixelStringComplete;
            }*/ 
            //programOutput.value = "int data" + i +  "[50][3] = {" + programOutput.value;
            programOutput.value = "const byte data" + i + "[] PROGMEM = {"+ theColorEncoder(tempAnimationData[i]) + "};" + programOutput.value;
        }
        
        
    }

    var generateTheCodeFuncForMeta = function(){
        var pixelString, pixelStringComplete;
        var programOutput = document.getElementById("programOutput"); 
        
        //console.log(tempAnimationData.length - 1);
        for(var i = (tempAnimationData.length - 1); i >= 0; i--){
            //programOutput.value = "};  decodeTheColor(data" + i + "); delay(700);" + '\n'+ programOutput.value;
            /*for(var j = (tempAnimationData[i].length - 1); j >= 0; j--){

                if(j == tempAnimationData[i].length - 1){
                    pixelString = "{" + tempAnimationData[i][j] + "}";
                }
                else{
                    pixelString = "{" + tempAnimationData[i][j] + "},";
                }
                //console.log(pixelString);
                programOutput.value = pixelString + programOutput.value;
                pixelStringComplete = pixelString + pixelStringComplete;
            }*/ 
            //programOutput.value = "int data" + i +  "[50][3] = {" + programOutput.value;
            programOutput.value = "const byte data" + i + "[] = {"+ theColorEncoder(tempAnimationData[i]) + "}; decodeTheColor(data" + i + ", sizeof(data0));" + programOutput.value;
        }
        
        
    }

    var generateTheCodeFuncForNoSize = function(){
        var pixelString, pixelStringComplete;
        var programOutput = document.getElementById("programOutput"); 
        
        //console.log(tempAnimationData.length - 1);
        for(var i = (tempAnimationData.length - 1); i >= 0; i--){
            //programOutput.value = "};  decodeTheColor(data" + i + "); delay(700);" + '\n'+ programOutput.value;
            /*for(var j = (tempAnimationData[i].length - 1); j >= 0; j--){

                if(j == tempAnimationData[i].length - 1){
                    pixelString = "{" + tempAnimationData[i][j] + "}";
                }
                else{
                    pixelString = "{" + tempAnimationData[i][j] + "},";
                }
                //console.log(pixelString);
                programOutput.value = pixelString + programOutput.value;
                pixelStringComplete = pixelString + pixelStringComplete;
            }*/ 
            //programOutput.value = "int data" + i +  "[50][3] = {" + programOutput.value;
            programOutput.value = "const byte dataa" + i + "[] = {"+ theColorEncoder(tempAnimationData[i]) + "}; decodeTheColor(dataa" + i + ");" + programOutput.value;
        }
        
        console.log("Length ", tempAnimationData.length);
    }

    var theColorEncoder = function(data){
        var encodedValue = 0;	
        colorCodeArray = []
        /*for(var j = 0; j <= incomingData.length; j++){
            console.log(incomingData[j]);
            if(incomingData[j] == [0, 0, 0]){
                        encodedValue = 1;
                    }
        }*/
        for(var i = 0; i <= data.length -1; i++){
            console.log(data[i]);
                    if(data[i].toString() == [0, 0 ,0]){console.log("First");
                        encodedValue = 0;colorCodeArray.push(encodedValue);
                    }
                    else if(data[i].toString() == [255, 255, 255]){
                        encodedValue = 1;colorCodeArray.push(encodedValue);
                    }
                    
                    else if(data[i].toString() == [255, 0, 0]){
                        encodedValue = 2;colorCodeArray.push(encodedValue);
                    }

                    else if(data[i].toString() == [0, 128, 0]){
                        encodedValue = 3;colorCodeArray.push(encodedValue);
                    }


                    else if(data[i].toString() == [0, 0, 255]){
                        encodedValue = 4;colorCodeArray.push(encodedValue);
                    }


                    else if(data[i].toString() == [255, 255, 0]){
                        encodedValue = 5;colorCodeArray.push(encodedValue);
                    }


                    else if(data[i].toString() == [255, 0, 255]){
                        encodedValue = 6;colorCodeArray.push(encodedValue);
                    }

                    else if(data[i].toString() == [0, 255, 255]){
                        encodedValue = 7;colorCodeArray.push(encodedValue);
                    }

                    else{
                        console.log("Got Here!");
                        encodedValue = 0;colorCodeArray.push(encodedValue);
                    }

        }
        console.log("color value array", colorCodeArray);
        return colorCodeArray;
    
    }
</script>
</body>

</html>



